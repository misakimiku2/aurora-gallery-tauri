## 实现计划

### 1. 修改 ContextMenu.tsx

**添加新的 props：**
- `tabs: TabState[]` - 所有标签页状态，用于检测是否存在图片对比标签页
- `handleAddToCompareCanvas: (tabId: string, imageIds: string[]) => void` - 添加图片到现有画布的回调

**修改图片对比菜单项逻辑 (第194-209行附近)：**
- 检测是否存在 `isCompareMode === true` 的标签页
- 如果存在，显示二级菜单（使用嵌套菜单或展开式菜单）
- 二级菜单项包括：
  - 每个现有画布："添加到 '画布XX' 当前数量/24"
  - 分隔线
  - "新建画布"

### 2. 修改 App.tsx

**添加新函数 `handleAddToCompareCanvas`：**
```typescript
const handleAddToCompareCanvas = useCallback((tabId: string, imageIds: string[]) => {
  // 1. 找到目标标签页
  // 2. 将 imageIds 添加到该标签页的 selectedFileIds 中
  // 3. 自动切换到该标签页
  setState(prev => ({
    ...prev,
    activeTabId: tabId,
    tabs: prev.tabs.map(tab => 
      tab.id === tabId 
        ? { ...tab, selectedFileIds: [...tab.selectedFileIds, ...imageIds] }
        : tab
    )
  }));
}, [setState]);
```

**传递新 props 给 ContextMenu：**
- 添加 `tabs={state.tabs}`
- 添加 `handleAddToCompareCanvas={handleAddToCompareCanvas}`

### 3. 添加翻译文本

在 `translations.ts` 中添加：
- `context.addToCanvas: '添加到画布'`
- `context.newCanvas: '新建画布'`

### 4. 实现细节

**二级菜单样式：**
- 使用与现有菜单一致的样式
- 悬停显示子菜单或点击展开
- 显示每个画布的当前图片数量（`tab.selectedFileIds.length`）
- 最大容量为 24 张

**边界处理：**
- 如果画布已满（24张），禁用该选项
- 如果添加后超过24张，只添加能容纳的数量并提示用户

### 修改文件清单
1. `src/components/ContextMenu.tsx` - 主要修改，添加二级菜单逻辑
2. `src/App.tsx` - 添加 `handleAddToCompareCanvas` 函数并传递 props
3. `src/utils/translations.ts` - 添加新的翻译键值