## 问题分析

问题出在 `ImageComparer.tsx` 第 1374-1382 行的组件卸载清理 effect：

```typescript
useEffect(() => {
  return () => {
    onReferenceModeChangeRef.current?.(false);
    const window = getCurrentWindow();
    window.setAlwaysOnTop(false);
    setWindowMinSize(1280, 800);  // ← 问题在这里！
  };
}, []);
```

当用户退出图片对比组件时，这个清理函数会执行，调用 `setWindowMinSize(1280, 800)`。在 Tauri 中，当窗口处于最大化状态时，调用 `set_window_min_size` 会导致窗口被取消最大化。

## 修复方案

### 修改 1：tauri-bridge.ts
添加 `isWindowMaximized` 函数用于检测窗口是否处于最大化状态：

```typescript
import { getCurrentWindow } from '@tauri-apps/api/window';

export const isWindowMaximized = async (): Promise<boolean> => {
  try {
    const window = getCurrentWindow();
    return await window.isMaximized();
  } catch (error) {
    console.error('Failed to check window maximized state:', error);
    return false;
  }
};
```

### 修改 2：ImageComparer.tsx - 卸载清理 effect
在调用 `setWindowMinSize` 之前，先检查窗口是否最大化：

```typescript
useEffect(() => {
  return () => {
    onReferenceModeChangeRef.current?.(false);
    const window = getCurrentWindow();
    window.setAlwaysOnTop(false);
    
    // 检查窗口是否最大化，只在非最大化时设置最小尺寸
    window.isMaximized().then(isMaximized => {
      if (!isMaximized) {
        setWindowMinSize(1280, 800);
      }
    });
  };
}, []);
```

### 修改 3：ImageComparer.tsx - toggleReferenceMode 函数
同样修复退出参考模式时的逻辑：

```typescript
} else {
  // Exit reference mode
  const savedState = sidebarStateBeforeRef.current;
  const currentSize = await window.innerSize();
  const isMaximized = await window.isMaximized(); // 新增
  
  if (!isMaximized && (currentSize.width < 1280 || currentSize.height < 800)) {
    await animateWindowResize(1280, 800, 70);
  }
  
  // ... 恢复侧边栏状态 ...

  // 只在窗口未最大化时设置最小尺寸
  if (!isMaximized) {
    await setWindowMinSize(1280, 800);
  }
}
```

## 预期效果
- 当窗口处于最大化状态时，退出图片对比组件不会再导致窗口被取消最大化
- 正常窗口（非最大化）的行为保持不变
- 参考模式的进入/退出也不会影响最大化状态