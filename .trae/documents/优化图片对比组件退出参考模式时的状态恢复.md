## 优化目标
优化 `ImageComparer.tsx` 中退出参考模式时的状态恢复逻辑

## 具体修改内容

### 1. 添加状态保存的 ref
在组件中添加两个 ref 来保存进入参考模式前的侧边栏状态：
```typescript
const sidebarStateBeforeRef = useRef<{ isSidebarVisible: boolean; isMetadataVisible: boolean } | null>(null);
```

### 2. 修改 `toggleReferenceMode` 函数

**进入参考模式时（newMode = true）：**
- 保存当前的侧边栏状态到 ref
- 关闭左右侧边栏（现有逻辑）

**退出参考模式时（newMode = false）：**
- 恢复之前保存的侧边栏状态（如果之前是开启的，则重新开启）
- 检查当前窗口尺寸，如果小于 1280x800，则恢复到 1280x800
- 恢复窗口最小尺寸为 1280x800（现有逻辑）

### 3. 修改位置
- 文件：`src/components/ImageComparer.tsx`
- 主要修改 `toggleReferenceMode` 函数（第 1731-1763 行）

## 代码变更预览

```typescript
// 添加 ref 保存进入参考模式前的状态
const sidebarStateBeforeRef = useRef<{ isSidebarVisible: boolean; isMetadataVisible: boolean } | null>(null);

// 在 toggleReferenceMode 函数中修改
const toggleReferenceMode = useCallback(async () => {
  const newMode = !isReferenceMode;
  setIsReferenceMode(newMode);
  onReferenceModeChangeRef.current?.(newMode);

  try {
    const window = getCurrentWindow();
    await window.setAlwaysOnTop(newMode);

    if (newMode) {
      // 进入参考模式：保存当前侧边栏状态
      const currentLayout = layoutPropRef.current;
      sidebarStateBeforeRef.current = {
        isSidebarVisible: currentLayout?.isSidebarVisible ?? false,
        isMetadataVisible: currentLayout?.isMetadataVisible ?? false
      };
      
      await setWindowMinSize(200, 200);
      setTimeout(() => {
        const currentLayout = layoutPropRef.current;
        const currentOnLayoutToggle = onLayoutToggleRef.current;
        if (currentLayout?.isSidebarVisible) {
          currentOnLayoutToggle?.('sidebar');
        }
        if (currentLayout?.isMetadataVisible) {
          currentOnLayoutToggle?.('metadata');
        }
      }, 50);
    } else {
      // 退出参考模式：恢复侧边栏状态
      const savedState = sidebarStateBeforeRef.current;
      const currentLayout = layoutPropRef.current;
      const currentOnLayoutToggle = onLayoutToggleRef.current;
      
      if (savedState) {
        // 如果之前侧边栏是开启的，现在重新开启
        if (savedState.isSidebarVisible && !currentLayout?.isSidebarVisible) {
          currentOnLayoutToggle?.('sidebar');
        }
        if (savedState.isMetadataVisible && !currentLayout?.isMetadataVisible) {
          currentOnLayoutToggle?.('metadata');
        }
        sidebarStateBeforeRef.current = null;
      }
      
      // 检查窗口尺寸，如果小于 1280x800 则恢复
      const currentSize = await window.innerSize();
      if (currentSize.width < 1280 || currentSize.height < 800) {
        await window.setSize(new LogicalSize(1280, 800));
      }
      
      await setWindowMinSize(1280, 800);
    }
  } catch (error) {
    console.error('Failed to toggle reference mode:', error);
  }
}, [isReferenceMode]);
```

## 预期效果
1. 进入参考模式前如果侧边栏是开启的，退出时会自动恢复
2. 退出参考模式时，如果窗口尺寸小于 1280x800，会自动调整到 1280x800
3. 保持现有功能不变